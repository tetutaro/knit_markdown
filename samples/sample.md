---
title: knit_markdownにおけるMarkdownの書き方
author:
- tetutaro \thanks{github.com/tetutaro/}
- tetsutaro.maruyama \thanks{tetsutaro.maruyama[at]gmail.com}
abstract: knit_markdown を使って Markdown を \LaTeX 経由で PDF に変換する場合の書式
date: \jtoday
bib: sample.bib
---

# ドキュメントのヘッダの書き方

Markdown の先頭に YAML を書くことによって、
タイトルなどのドキュメントのヘッダを生成できる。
YAML は `---` という行で囲む必要がある。

## ドキュメントのヘッダの例

```{caption="ドキュメントのヘッダの例"}
---
title: タイトル
author: 著者名
abstract: 概要
date: \jtoday
bib: sample.bib
---
```

## ドキュメントのヘッダの各項目の説明

title
: タイトル（省略可）
: 省略するとヘッダ自体が出力されない

author
: 著者名（省略可）
: 複数の場合はYAMLの箇条書き（このMarkdown参照）にする

abstract
: 概要（省略可）

data
: 日付（省略可）
: `\jtoday`とすることで `YYYY/MM/DD` 形式のコンパイル当日の日付になる
: 省略すると `YYYY年MM月DD日` 形式のコンパイル当日の日付になる

bib
: 参考文献が書かれたファイル名（省略可）
: 詳細は[@sec:cite]にて

# 一般的な Markdown の書式

## 記号付き箇条書き

* `* ` を文頭に付けることによって、記号付き箇条書きになる
* `- ` だと箇条書きにならない
	* 行頭にインデントをつけると箇条書きも１段下がる
	* 記号も白抜き丸になる
		* レベル３の箇条書き
        * 一般的には深さはここまでにすべき
			* レベル４の箇条書き
			* 最大でレベル４まで

\newpage

## 順序付き箇条書き

#. `#. ` を文頭につけることによって、順序付き箇条書きになる
#. `#. ` を使うと自動的にナンバリングされる
	#. `#. ` のレベル２はローマ数字
	    #. `#. ` のレベル３はアルファベット
	    #. 一般的に深さはここまでにすべき
	        #. `#. ` のレベル４もアルファベット
2. `1. ` のように数字とピリオドでも、順序付き箇条書きになる
    8. 数字は何でも良く、自動的にナンバリングされる
    1. なので全部 `1. `で良い
    5. ただし、各レベルの最初の数字だけは、その数が反映される
    3. またこの場合、レベルに関わらず、ナンバリングは数字になる
9) `1) ` のように数字と半括弧でも、順序付き箇条書きになる
    7) 数字のナンバリング規則はピリオドの場合と同様
    #) ナンバリングをシャープにしても同様
(5) `(5) ` のように数字と両括弧でも、順序付き箇条書きになる
ix. アラビア数字を指定することも出来る
e. アルファベットを指定することも出来る
#. そこからシャープに戻すと、直前のナンバリングが継承される

## 箇条書きのまとめ

* 記号付き箇条書き
    * マーカー形式は `* ` （アスタリスク＋空白）のみ
#. 順序付き箇条書き
    1) ナンバリング形式＋マーカー形式＋空白を文頭につける
    1) 許容されるナンバリング形式
        (1) シャープ
            * 設定された形式もしくは同レベル直前の形式の継承
        (1) 数字
            * 設定に関わらず数字になる
            * レベル最初の場合のみ値が反映
        (1) アラビア数字
            * 小文字のみ
            * 設定に関わらずアラビア文字になる
            * レベル最初の場合のみ値が反映
        (1) アルファベット
            * 小文字のみ
            * 設定に関わらずアルファベットになる
            * レベル最初の場合のみ値が反映
    1) 許容されるマーカー形式
        (1) ピリオド
        (1) 半括弧
        (1) 両括弧
* トップレベルの記号付き/順序付き、ナンバリング形式/マーカー形式の変更
    #. 前の箇条書きとは異なる箇条書きだと見做される
    #. よって、箇条書きの間に行間が入ってしまう

## 定義リスト

word
: definition

単語と
: それに続くコロンから始まる行

単語間は
: １行開けなくてはならない

定義は
: ひとつ書いて
: もうひとつを書くこともできる

単語は
: 太文字で表示される

## テーブル

テーブルの書式には４種類が存在するが、
実際には２種類使えれば十分であろう。

### シンプルテーブル

ヘッダ１ ヘッダ２     ヘッダ３
-------- ------------ ----------
ヘッダの 下にハイフン を書くだけ
各行が   テーブルの   １行になる
列の開始 位置を揃える 必要がある

キャプションを付けない場合

### パイプテーブル

| ヘッダ１ | ヘッダ２ | ヘッダ３ | ヘッダ４ |
|:---:|:---|---:|---|
| 中央寄せ | 左寄せ | 右寄せ | デフォルト |
| セルを | パイプで | 囲む | やり方 |
| 一行の | セルの数は | 少なくても |
| | | | 構わない |

: キャプションは１行空けてコロンから始める {#tbl:sample1}

テーブルにラベルをつけたい場合は、
キャプションにしかラベルが付かないので、
キャプションを書く必要がある

## インラインでの文章強調

テキストを強調するには *アスタリスク* で囲む。
アスタリスクと強調したい文字の間に *空白が入ると 強調されない* ので注意。

- `H~2~O` → H~2~0 : チルダで囲むと下付き文字
- `x^2^` → x^2^ : ハットで囲むと上付き文字

文字に色をつけたい場合は \LaTeX のコマンドを直接書く。
`\textcolor{red}{赤い文字}`が\textcolor{red}{赤い文字}の様になる。

## verbatim, コードブロック

`> command` のようにひとつのグレイヴ・アクセント（\`）で囲むと、
インラインのverbatimになる。
フォントと背景色を変えている。

```{#code:sample1 caption="コードブロックのサンプル"}
３つのグレイヴ・アクセントで囲まれたブロック（コードブロック）は
特にコードを書き記すことを想定して設定している。
{caption="hogehoge"}でキャプションを付けることができる。
```

## 数式{#sec:sample1}

インライン形式の数式は $f(x)=3x+2$ の様に`$数式$`とダラーで囲む。
この場合、ダラーと数式の間に空白を入れないこと。

ディスプレイ形式の数式は、`$$数式$$`と２重のダラーで囲む。

$$
f(x) = 3x + 2 {#eq:sample1}
$$

自動的にequation環境に変換しているため、数式に必ず番号が振られてしまう。
番号を振りたくない場合は`\nonumber`を付けなければならない。

またequation環境は複数行の数式も書けないが、
数式中に改行（２重バックスラッシュ）もしくはアンパッサンドがあれば
align環境と自動的に判断する。

$$
f(x) & = (x - 2)(x + 1) \nonumber \\
& = x^2 - x - 2
$$

## 外部リンクと画像

ただ単にHTMLへのリンクを張りたい場合は、
<http://google.com>のようにURLを不等号記号で囲む（`<http://google.com>`）。
リンクにタイトルを付けたい場合は、
[google](http://google.com)のように角括弧で囲まれたタイトルと、
それに続く括弧のURLの組で表せる。（`[google](http://google.com)`）

また、最初にエクスクラメーションマークが付いたリンクは
画像として扱われる（`![虎の画像](tiger.png)`）。
大きすぎる画像は適当にリサイズされる。

![虎の画像](tiger.png){#fig:sample1}

\newpage

# ブロック

beamerから \LaTeX コマンドを移植したので、
通常の \LaTeX であってもブロックを描くことが出来る。

## セクションとブロック

* レベル３のセクションに明示的にクラスを指定すると、ブロックを生成する
* ブロックを生成するクラスは以下
	* ブロック : block
	* アラートブロック : alertblock
	* 例ブロック : exampleblock
	* 定理 : theorem
    * 定義 : definition
	* 例 : example
	* 証明 : proof

### 通常のsubsubsection

レベル３のセクションでも、クラスを与えないと、普通のsubsubsectionになる。
また、セクションの深さはこの３までである。

## デフォルトのブロック

### ブロックのサンプル {#block:sample1 .block}

タイトルを付けると自動的にヘッダが付く。

* 箇条書きなどがあっても
* 明示的に終了させないと
* ブロックの中に入る

### {.block}

タイトルを付けないとヘッダ無しになる。

```{caption="ブロックの書き方"}
### タイトル {.block}

ブロックの内容
```

## ブロックの終了

### 次のセクションまで {.block}

クラスを付けたレベル３のセクションが始まってから、
次の何らかのセクションやブロックが指定されるまでがブロックになる。

### 明示的に終わらせる場合 {.block}

`<!-- -->`というHTMLのコメントの１行を入れる。

<!-- -->

この行の前に`<!-- -->`が入っているので、この行はブロックの外になる。

## アラートブロック

レベル３のセクションにalertblockクラスを付けるとアラートブロックになる。

### アラートブロックのサンプル {#block:sample2 .alertblock}

タイトルを付けると自動的にヘッダが付く。

### {.alertblock}

タイトルを付けないとヘッダ無しになる。

```{caption="アラートブロックの書き方"}
### タイトル {.alertblock}

アラートブロックの内容
```

\newpage

## 例ブロック

レベル３のセクションにexampleblockクラスを付けると例ブロックになる。

### 例ブロックのサンプル {#block:sample3 .exampleblock}

タイトルを付けると自動的にヘッダが付く。

### {.exampleblock}

タイトルを付けないとヘッダ無しになる。

```{caption="例ブロックの書き方"}
### タイトル {.exampleblock}

例ブロックの内容
```

## 定理

レベル３のセクションにtheoremクラスを付けると定理になる。

### 定理のサンプル {#theo:sample1 .theorem}

タイトル有りの場合。タイトルには自動的に「定理」と通番が付けられる。

### {.theorem}

タイトルを書かないと、「定理」と通番だけのヘッダが付けられる。

```{caption="定理の書き方"}
### タイトル {.theorem}

定理の内容
```

## 定義

レベル３のセクションにdefinitionクラスを付けると定義になる。

### 定義のサンプル {#def:sample1 .definition}

タイトル有りの場合。タイトルには自動的に「定義」と通番が付けられる。

### {.definition}

タイトルを書かないと、「定義」と通番だけのヘッダが付けられる。

```{caption="定義の書き方"}
### タイトル {.definition}

定義の内容
```

## 例

レベル３のセクションにexampleクラスを付けると例になる。

### 例のサンプル {#exam:sample1 .example}

タイトル有りの場合。タイトルには自動的に「例」と通番が付けられる。

### {.example}

タイトルを書かないと、「例」と通番だけのヘッダが付けられる。

```{caption="例の書き方"}
### タイトル {.example}

例の内容
```

### 例ブロックと例の違い

- 例はタイトルの前に「例」と通番が付くが、例ブロックには何も付かない
- タイトルが無い場合、例ブロックはヘッダが消えるが、例は「例」と通番だけのヘッダが付けられる

## 証明

レベル３のセクションにproofクラスを付けると証明になる。

### 証明のサンプル {#block:sample4 .proof}

タイトル有りの場合。

### {.proof}

タイトルを書かないと、「証明」というタイトルだけのヘッダが付けられる。

```{caption="証明の書き方"}
### タイトル {.proof}

証明の内容
```

\newpage

# ラベル・参照と引用

最後にラベル・参照・引用について説明する。

## ラベルと参照

ラベルの書き方は`{#タイプ:名前}`。必ずコロンを入れる。
また、参照の書き方は`[@タイプ:名前]`。ラベルと同じタイプ・名前そして必ずコロンを入れる。

ラベルを付けたいもの タイプ
-------------------- ------------
章                   sec/section
図                   fig/figure
表                   tbl/table
数式                 eq/equation
定理                 theo/theorem
定義                 def/definition
例                   exam/example

## 章のラベル・参照

ラベルはタイトルに続けて書く。
タイプに`sec`もしくは`section`を指定する。
参照は[@sec:sample1]の様に「章」を書かなくても自動的に付く。

```{caption="章のラベル・参照の書き方"}
## セクションのタイトル {#sec:sample}

[@sec:sample]を参照のこと
```

\newpage

## 図のラベル・参照

ラベルはファイルの指定の後に続けて書く。
タイプに`fig`もしくは`figure`を指定する。
参照すると[@fig:sample1]の様に「図」を書かなくても自動的に付く。

```{caption="図のラベル・参照の書き方"}
![サンプル画像](sample.png) {#fig:sample}

[@fig:sample]を参照のこと
```

## 表のラベル・参照

ラベルは表のキャプションの後に続けて書く。
タイプに`tbl`もしくは`table`を指定する。
参照は[@tbl:sample1]の様に「表」を書かなくても自動的に付く。

```{caption="表のラベル・参照の書き方"}
| Header One  | Header Two |
| :---------- | :--------- |
| Cell One    | Cell Two   |

: キャプション {#tbl:sample}

[@tbl:sample]を参照のこと
```

\newpage

## 数式のラベル・参照

ディスプレイ形式の、nonumberを付けてない行に対してラベルを書く。
タイプに`eq`もしくは`equation`を指定する。
参照は[@eq:sample1]の様に「式」と括弧が自動的に付く。

```{caption="数式のラベル・参照の書き方"}
$$
f(x) = 3x + 2 {#eq:sample}
$$

[@eq:sample]を参照のこと
```

## 定理系のラベル・参照

レベル３のセクションのクラスとしてtheorem, definition, exampleを付けると
それぞれ定理・定義・例のブロックになるが、
それと同時にラベルを指定することができる。
タイプは定理が`theo`もしくは`theorem`、定義が`def`もしくは`definition`、
例が`exam`もしくは`example`。
参照は[@theo:sample1]、[@def:sample1]、[@exam:sample1]のように
それぞれの名前が自動的に付く。

```{caption="定理・定義・例のラベル・参照の書き方"}
### 定理のサンプル {#theo:sample .theorem}

### 定義のサンプル {#def:sample .definition}

### 例のサンプル {#exam:sample .example}

[@theo:sample]、[@def:sample]、[@exam:sample]を参照のこと
```

\newpage

## コードブロックのラベル・参照

コードブロックはcaptionというオプションを付けることでキャプションをつけることができるが、
上記の定理系と同様に同時にラベルを指定することが出来る。
タイプは特に指定はないが、参照と同じラベルで今までに出てきなものではないもの、
例えば`code`などが良いと思われる。
参照は[@code:sample1]のようにキャプションに自動的に変換される。

```{caption="コードブロックのラベル・参照の書き方"}
　```{#code:sample caption="sample code"}
　sample code
　```

　[@code:sample]を参照のこと
```

## その他ブロック系のラベル・参照

block, alterblock, exampleblock, proof といった
番号が自動的に割り振られないブロックも、
コードブロックと同様にタイトルが付いたものならばラベルを指定できる。
タイプは特に指定はないが、参照と同じラベルで今までに出てきなものではないもの、
例えば`block`などが良いと思われる。
参照は[@block:sample1]、[@block:sample2]、[@block:sample3]、[@block:sample4]
のようにタイトルに自動的に変換される。

```{caption="その他のブロック系のラベル・参照の書き方"}
### ブロックのサンプル {#block:sample1 .block}

### アラートブロックのサンプル {#block:sample2 .alertblock}

### 例ブロックのサンプル {#block:sample3 .exampleblock}

### 証明のサンプル {#block:sample4 .proof}

[@block:sample1]、[@block:sample2]、
[@block:sample3]、[@block:sample4]を参照のこと
```

## 引用 {#sec:cite}

まずはBibTeX形式で書かれた参考文献ファイルを用意する。
BibTeX形式は、[Google Scholar](https://scholar.google.com/)や
[Mendeley](https://www.mendeley.com/)で表示できるので、
わざわざ自分で書く必要はなく、これらからコピペで良い。
（BibTex形式の書き方は [Wikipedia - BibTex](https://ja.wikipedia.org/wiki/BibTeX) に詳しい）

例えば以下のようなファイルを`sample.bib`というファイル名で用意する

```{#code:bibsample caption="sample.bib"}
@article{samplearticle,
  title={Title of Sample Article},
  author={Someone Hogehoge},
  journal={Journal of something},
  year={2017}
}
@book{samplebook,
  title={Title of Sample Book},
  author={Someone Mogemoge},
  year={2017},
  publisher={Dummy Publisher}
}
```

Markdownの先頭に書いたYAML形式のヘッダに、上記の例では
`bib: sample.bib`と書くと、
自動的にこの参照文献ファイルが読み込まれ、
`[@samplearticle]` → [@samplearticle]のように
引用することによって、参考文献リスト（[@code:bibsample]）とそこへのリンクが生成される。

参考文献リストにあっても引用されていないものは、
参考文献リストには表示されない。
参考文献リストが本文中で全く引用されていない場合は、
参考文献という章自体が全く表示されない。

引用の場合は、`[@引用元]`のようにコロンは入れてはならない。
コロンの有る無しで参照か引用か判断しているからである。
